{{ $script := resources.Get "js/webmention.js" | resources.Minify | resources.Fingerprint }} 

{{ if .Site.IsServer }}
    <script
        src="{{ $script.Permalink }}"
        integrity="{{ $script.Data.Integrity }}"
        data-page-url="{{ .Permalink }}"
        data-wordcount="100"
        async></script>
{{ else }}
    <script
        src="{{ $script.Permalink }}"
        integrity="{{ $script.Data.Integrity }}"
        data-wordcount="100"
        async></script>
{{ end }}

{{ $commentparade := "https://quill.p3k.io?dontask=1&name=dontask&me=https%3A%2F%2Fcommentpara.de%2F&reply=" }}
{{ $permalink := (urlquery .Permalink) | safeURL }}

<!-- Webmentions will be rendered in this section using webmention.js -->
<section class="webmentions section" id="webmentions">
    <h2>Webmentions</h2>

    <p class="supplement">{{ i18n "loading_comments" }} <a href="{{ $commentparade }}{{ $permalink }}" target="_blank">{{ i18n "wannabe_first" }}</a></p>
</section>

<!-- Share buttons -->
<p>
    {{ with $.Site.Params.webmention_url }}
        <a class="button btn external" href="{{ . }}" target="_blank">webmention this</a>
    {{ end }}
    
    <a class="button btn" href="{{ $commentparade }}{{ $permalink }}" target="_blank">leave a comment</a>
</p>